{"remainingRequest":"/Users/enrico/code/angular/fp_web/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--3-1!/Users/enrico/code/angular/fp_web/node_modules/instantsearch.js/es/connectors/clear-all/connectClearAll.js","dependencies":[{"path":"/Users/enrico/code/angular/fp_web/node_modules/instantsearch.js/es/connectors/clear-all/connectClearAll.js","mtime":499162500000},{"path":"/Users/enrico/code/angular/fp_web/node_modules/cache-loader/dist/cjs.js","mtime":1522355410796},{"path":"/Users/enrico/code/angular/fp_web/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1522355408304}],"contextDependencies":[],"result":["import { checkRendering, getRefinements, clearRefinementsFromState, clearRefinementsAndSearch } from '../../lib/utils.js';\n\nvar usage = 'Usage:\\nvar customClearAll = connectClearAll(function render(params, isFirstRendering) {\\n  // params = {\\n  //   refine,\\n  //   hasRefinements,\\n  //   createURL,\\n  //   instantSearchInstance,\\n  //   widgetParams,\\n  // }\\n});\\nsearch.addWidget(\\n  customClearAll({\\n    [ excludeAttributes = [] ],\\n    [ clearsQuery = false ]\\n  })\\n);\\nFull documentation available at https://community.algolia.com/instantsearch.js/v2/connectors/connectClearAll.html\\n';\n\nvar refine = function refine(_ref) {\n  var helper = _ref.helper,\n      clearAttributes = _ref.clearAttributes,\n      hasRefinements = _ref.hasRefinements,\n      clearsQuery = _ref.clearsQuery;\n  return function () {\n    if (hasRefinements) {\n      clearRefinementsAndSearch(helper, clearAttributes, clearsQuery);\n    }\n  };\n};\n\n/**\n * @typedef {Object} CustomClearAllWidgetOptions\n * @property {string[]} [excludeAttributes = []] Every attributes that should not be removed when calling `refine()`.\n * @property {boolean} [clearsQuery = false] If `true`, `refine()` also clears the current search query.\n */\n\n/**\n * @typedef {Object} ClearAllRenderingOptions\n * @property {function} refine Triggers the clear of all the currently refined values.\n * @property {boolean} hasRefinements Indicates if search state is refined.\n * @property {function} createURL Creates a url for the next state when refinements are cleared.\n * @property {Object} widgetParams All original `CustomClearAllWidgetOptions` forwarded to the `renderFn`.\n */\n\n/**\n * **ClearAll** connector provides the logic to build a custom widget that will give the user\n * the ability to reset the search state.\n *\n * This connector provides a `refine` function to remove the current refined facets.\n *\n * The behaviour of this function can be changed with widget options. If `clearsQuery`\n * is set to `true`, `refine` will also clear the query and `excludeAttributes` can\n * prevent certain attributes from being cleared.\n *\n * @type {Connector}\n * @param {function(ClearAllRenderingOptions, boolean)} renderFn Rendering function for the custom **ClearAll** widget.\n * @param {function} unmountFn Unmount function called when the widget is disposed.\n * @return {function(CustomClearAllWidgetOptions)} Re-usable widget factory for a custom **ClearAll** widget.\n * @example\n * // custom `renderFn` to render the custom ClearAll widget\n * function renderFn(ClearAllRenderingOptions, isFirstRendering) {\n *   var containerNode = ClearAllRenderingOptions.widgetParams.containerNode;\n *   if (isFirstRendering) {\n *     var markup = $('<button id=\"custom-clear-all\">Clear All</button>');\n *     containerNode.append(markup);\n *\n *     markup.on('click', function(event) {\n *       event.preventDefault();\n *       ClearAllRenderingOptions.refine();\n *     })\n *   }\n *\n *   var clearAllCTA = containerNode.find('#custom-clear-all');\n *   clearAllCTA.attr('disabled', !ClearAllRenderingOptions.hasRefinements)\n * };\n *\n * // connect `renderFn` to ClearAll logic\n * var customClearAllWidget = instantsearch.connectors.connectClearAll(renderFn);\n *\n * // mount widget on the page\n * search.addWidget(\n *   customClearAllWidget({\n *     containerNode: $('#custom-clear-all-container'),\n *   })\n * );\n */\nexport default function connectClearAll(renderFn, unmountFn) {\n  checkRendering(renderFn, usage);\n\n  return function () {\n    var widgetParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var _widgetParams$exclude = widgetParams.excludeAttributes,\n        excludeAttributes = _widgetParams$exclude === undefined ? [] : _widgetParams$exclude,\n        _widgetParams$clearsQ = widgetParams.clearsQuery,\n        clearsQuery = _widgetParams$clearsQ === undefined ? false : _widgetParams$clearsQ;\n\n\n    return {\n      // Provide the same function to the `renderFn` so that way the user\n      // has to only bind it once when `isFirstRendering` for instance\n      _refine: function _refine() {},\n      _cachedRefine: function _cachedRefine() {\n        this._refine();\n      },\n      init: function init(_ref2) {\n        var helper = _ref2.helper,\n            instantSearchInstance = _ref2.instantSearchInstance,\n            createURL = _ref2.createURL;\n\n        this._cachedRefine = this._cachedRefine.bind(this);\n\n        var clearAttributes = getRefinements({}, helper.state).map(function (one) {\n          return one.attributeName;\n        }).filter(function (one) {\n          return excludeAttributes.indexOf(one) === -1;\n        });\n\n        var hasRefinements = clearsQuery ? clearAttributes.length !== 0 || helper.state.query !== '' : clearAttributes.length !== 0;\n        var preparedCreateURL = function preparedCreateURL() {\n          return createURL(clearRefinementsFromState(helper.state, [], clearsQuery));\n        };\n\n        this._refine = refine({\n          helper: helper,\n          clearAttributes: clearAttributes,\n          hasRefinements: hasRefinements,\n          clearsQuery: clearsQuery\n        });\n\n        renderFn({\n          refine: this._cachedRefine,\n          hasRefinements: hasRefinements,\n          createURL: preparedCreateURL,\n          instantSearchInstance: instantSearchInstance,\n          widgetParams: widgetParams\n        }, true);\n      },\n      render: function render(_ref3) {\n        var results = _ref3.results,\n            state = _ref3.state,\n            createURL = _ref3.createURL,\n            helper = _ref3.helper,\n            instantSearchInstance = _ref3.instantSearchInstance;\n\n        var clearAttributes = getRefinements(results, state).map(function (one) {\n          return one.attributeName;\n        }).filter(function (one) {\n          return excludeAttributes.indexOf(one) === -1;\n        });\n\n        var hasRefinements = clearsQuery ? clearAttributes.length !== 0 || helper.state.query !== '' : clearAttributes.length !== 0;\n        var preparedCreateURL = function preparedCreateURL() {\n          return createURL(clearRefinementsFromState(state, [], clearsQuery));\n        };\n\n        this._refine = refine({\n          helper: helper,\n          clearAttributes: clearAttributes,\n          hasRefinements: hasRefinements,\n          clearsQuery: clearsQuery\n        });\n\n        renderFn({\n          refine: this._cachedRefine,\n          hasRefinements: hasRefinements,\n          createURL: preparedCreateURL,\n          instantSearchInstance: instantSearchInstance,\n          widgetParams: widgetParams\n        }, false);\n      },\n      dispose: function dispose() {\n        unmountFn();\n      }\n    };\n  };\n}",null]}